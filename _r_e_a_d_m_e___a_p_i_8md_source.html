<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Malbolge: README_API.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Malbolge
   &#160;<span id="projectnumber">0.0.3</span>
   </div>
   <div id="projectbrief">Malbolge virtual machine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README_API.md</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;img src=&quot;../../../playground/logo.svg&quot; alt=&quot;Malbolge Logo&quot; width=&quot;250&quot;/&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# malbolge</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;A virtual machine to execute Malbolge programs, written in C++20.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;## Usage</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;You can load from a file like this:</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;```</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;malbolge my_prog.mal</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;```</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;The file extension is ignored.  Or you can pipe output into it:</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;```</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;cat my_prog.mal | malbolge</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;```</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;As a final alternative that is useful for programmatic execution, you can use</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;the `--string` flag:</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;```</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;malbolge --string &#39;This will not compile...&#39;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;```</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;Like any terminal application, you access help with `--help`.  You can also get</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;log output (in stderr) via increasing the number of `-l` switches, e.g.:</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;```</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;$ malbolge -ll ./test/programs/hello_world.mal</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;2020-07-05 11:53:31.095433[INFO]: Loading file: &quot;./test/programs/hello_world.mal&quot;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;2020-07-05 11:53:31.095504[DEBUG]: File size: 132</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;2020-07-05 11:53:31.095588[INFO]: File loaded</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;2020-07-05 11:53:31.095652[DEBUG]: Loaded size: 131</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;2020-07-05 11:53:31.122950[DEBUG]: Starting program</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;Hello World!</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;```</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;You can increase logging up to 3 levels.  As it is output into the error stream, you can split the logging output into a separate file to preserve the program output:</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;```</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;$ malbolge -lll ./test/programs/hello_world.mal  2&gt; logging.txt</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;Hello World!</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;```</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;## API Documentation</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;API documentation for Malbolge is available [here](https://cmannett85.github.io/malbolge).</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;## Playground</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;You can try out Malbolge programs in your browser using the new (_extremely_ primitive!) [playground](https://cmannett85.github.io/malbolge/playground).  The focus of the next Malbolge release will be to dramatically improve the playground.</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;## Dependencies</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;* C++ toolchain supporting C++20 (only tested using g++ v10.0.1)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;* Boost v1.67</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;* CMake v3.12</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;* Emscripten v2.0.6 (only needed for WASM build)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;* Doxygen (only needed for Documentation build)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;---</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;## What is Malbolge?</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;Malbolge is the name of the eighth circle of Hell in Dante&#39;s Inferno.  This sets the scene.</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;Invented in 1998 by Ben Olmstead, Malbolge isn&#39;t so much a programming language for humans, but a machine language for a fictional 10-trit ternary-based virtual CPU with 3 registers and a fixed size memory block.</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;#### Trit?  Ternary?</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;A trit is single unit of state in the Malbolge VM, it holds 1 of 3 possible states: `0`, `1`, or `2`.  In other words it is the 3-state equivalent of a bit.  A ternary is simply an unsigned integer made from trits.</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;Malbolge has a single native type, a 10-trit ternary (hereby referred to as just &#39;ternary&#39;).  3&lt;sup&gt;10&lt;/sup&gt; gives you 59049 possible values, in the range [0, 59048].  The values wrap upon under- and overflow.</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;#### Fixed Size Memory Block</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;The Malbolge virtual CPU is accompanied by a fixed size block of memory that holds 59049 addressable cells with each big enough to hold a single 10-trit ternary.</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;The fact that the virtual memory&#39;s size is fixed by the language itself, is why Malbolge cannot be considered Turing-complete.</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;&lt;a name=&quot;vcpu-registers&quot;&gt;&lt;/a&gt;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;#### vCPU Registers</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;The virtual CPU has 3 ternary registers:</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; - `a`: &#39;Accumulator&#39;, a general-purpose register</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; - `c`: &#39;Code pointer&#39;, holds the memory location of the current or next instruction</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; - `d`: &#39;Data pointer&#39;, holds the memory location of the current or next data value</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;&lt;a name=&quot;pre-ciphering&quot;&gt;&lt;/a&gt;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;#### Pre-ciphering</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;When a CPU cycle is begun, the value at the code pointer needs to undergo a simple ciphering in order to extract the actual value:</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;```</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;i = (*c - 33 + c) % 94</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;```</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;The subtraction of 33 is why `*c` must be checked to see if it lies in the graphical ASCII range ([33, 126]) first, if it doesn&#39;t it is an error and the program must abort.  `i` is an index into the pre-cipher table:</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;```</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;+b(29e*j1VMEKLyC})8&amp;m#~W&gt;qxdRp0wkrUo[D7,XTcA&quot;lI.v%{gJh4G\-=O@5`_3i&lt;?Z&#39;;FNQuY]szf$!BS/|t:Pn6^Ha</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;```</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;&lt;a name=&quot;post-ciphering&quot;&gt;&lt;/a&gt;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;#### Post-ciphering</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;Once processing on a CPU instruction has finished, it needs to be ciphered again before being written back into `*c` - that&#39;s right, Malbolbge modifies its code as it executes.  What fun.</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;```</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;i = *c - 33</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;```</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;Much like the [pre-ciphering](#pre-ciphering), the subtraction of 33 is why `*c` must be checked to see if it lies in the graphical ASCII range ([33, 126]) first, if it doesn&#39;t it is an error and the program must abort.  `i` is an index into the post-cipher table:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;```</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;5z]&amp;gqtyfr$(we4{WP)H-Zn,[%\3dL+Q&gt;U!pJS72FhOA1CB6v^=I_0/8|jsb9m&lt;.TVac`uY*MK&#39;X~xDl}REokN:#?G&quot;i@</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;```</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;#### Ternary Op</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;Another unique &#39;feature&#39; of Malbolge is the operation performed on two ternary values to produce another.  It is used for obfuscating the initial program data size in a memory block and can be triggered by a particular CPU instruction.</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;Each trit in the two input ternarys is used as an index into a table to produce a new trit value:</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;&lt;table&gt;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    &lt;td colspan=&quot;2&quot; rowspan=&quot;2&quot;&gt;&lt;/td&gt;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    &lt;th colspan=&quot;3&quot; style=&quot;text-align:center&quot;&gt;a&lt;/td&gt;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    &lt;th&gt;0&lt;/td&gt;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    &lt;th&gt;1&lt;/td&gt;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    &lt;th&gt;2&lt;/td&gt;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    &lt;th style=&quot;text-align:center&quot; rowspan=&quot;3&quot;&gt;b&lt;/td&gt;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    &lt;th&gt;0&lt;/td&gt;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    &lt;td&gt;1&lt;/td&gt;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    &lt;td&gt;0&lt;/td&gt;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    &lt;td&gt;0&lt;/td&gt;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    &lt;th&gt;1&lt;/td&gt;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    &lt;td&gt;1&lt;/td&gt;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    &lt;td&gt;0&lt;/td&gt;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    &lt;td&gt;2&lt;/td&gt;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    &lt;th&gt;2&lt;/td&gt;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    &lt;td&gt;2&lt;/td&gt;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    &lt;td&gt;2&lt;/td&gt;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    &lt;td&gt;1&lt;/td&gt;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;&lt;/table&gt;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;For example:</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;```</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;a = 0001112220</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;b = 0120120120</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    1120020211</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;```</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;**Note** this is referred to as the &#39;crazy operation&#39; on Wikipedia, I don&#39;t know where that name came from as it is not in the original specification or reference implementation - so I don&#39;t use it.  Also,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; it&#39;s not crazy, it&#39;s ridiculous.</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;#### vCPU Instructions</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;| Instruction | (as decimal) |                                                            Execution                                                            |</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;|:-----------:|:-----------:|:--------------------------------------------------------------------------------------------------------------------------------|</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;|      j      |     106     | Sets `d` to `*d`                                                                                                                |</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;|      i      |     105     | Sets `c` to `*d`                                                                                                                |</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;|      *      |      42     | Rotates the trits in `*d` to the right i.e. towards the least significant, and copy into `a`                                    |</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;|      p      |     112     | Perform the op using `a` and `*d`, then assign to `*d` and `a`                                                                  |</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;|      /      |      47     | Take a char from stdin and assign to `a`.  `EOF` is 59048                                                                       |</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;|      &lt;      |      60     | Write `a` to stdout.  Skip if `a` is 59048                                                                                      |</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;|      v      |     118     | Stops execution and exits the program                                                                                           |</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;|      o      |     111     | No-op.  This is only useful during program load, as all graphical ASCII non-instruction characters are ignored during execution |</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;### Program Load</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;On start the program data is processed:</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; 1. If a character is whitespace, it is discarded</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; 2. If a character is not graphical ASCII (i.e. outside the range [33, 126]), the program is malformed and execution aborted</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; 3. The character is [_pre-ciphered_](#pre-ciphering), and if the result is not an instruction, the program is malformed and execution aborted</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; 4. The program data, without whitespace and using the original instructions (not the pre-ciphered output), is then loaded into the start of the memory</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; 5. The remaining memory cells are then transformed using the result of the ternary op on the previous two cells i.e. `m[i] = op(m[i-1], m[i-2])`</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;### Program Execution</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;At program start, all the [registers](#vcpu-registers) are set to zero. Then the program follows this loop:</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; 1. Take the value at `*c` and [pre-cipher](#pre-ciphering) it.  If the input is not in the graphical ASCII range then the program is malformed and must abort</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; 2. If the result is an instruction then execute it, otherwise do nothing</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; 3. [Post-cipher](#post-ciphering) the result, and write it back to `*c`</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; 4. Increment `c` and `d`, they will wrap upon overflow</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;## Malbolge Reference</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;It should be noted that the specification and implementation differ (of course!), most notably in that the input and output instructions are reversed.  As most of the existing implementations are based on the original C code, and therefore most of the existing Malbolge programs are written for that, I too have followed the reference implementation.</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;#### Specification</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;http://www.lscheffer.com/malbolge_spec.html</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;#### Reference implementation</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;http://www.lscheffer.com/malbolge_interp.html</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;---</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;## CI System</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;The Malbolge project uses Github Actions to enfore strict code quality checks during a pull request:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;- Unit tests are ran</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;- Unit test code coverage calculated and if it is &gt;1% lower than the previous value, the PR is rejected (can be manually overridden)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;- Executable ran with a Hello World program and then checked with:</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  - AddressSanitizer</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  - LeakSanitizer</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  - UndefinedBehaviorSanitizer</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  - ThreadSanitizer</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;- Documentation generated, if it fails (because the API has changed and the documentation comments not updated to match), then the PR is rejected</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;- Release debian package and archives generated.  The debian package is installed, malbolge ran, and then uninstalled - any failure in that process will cause the PR to be rejected</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;- A WASM build is performed</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;I dabbled in `clang-format`, but it only seemed to make the formatting worse, so that will have to be manually checked.  `clang-tidy` will be integrated once it supports C++20 ranges, currently v10 produces errors for them that cannot be suppressed.</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;Once the PR is merged, the API documentation is generated and pushed to the [public documentation](https://cmannett85.github.io/malbolge) site.</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;## Contributing</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;Issues and PRs are always welcome, but seriously - why are you using it?</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;### Can I integrate the source into my own project?</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;Sure, but...  Err... **Why do you need it!?**</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
